(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["69dbc044"],{1663:function(t,a,e){"use strict";var i=e("3553"),s=e.n(i);s.a},"300c":function(t,a,e){"use strict";var i=e("a157"),s=e.n(i);s.a},3553:function(t,a,e){},"400a":function(t,a,e){},"5b85":function(t,a,e){"use strict";e.r(a);var i,s=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"mypage",staticStyle:{height:"calc(100vh - 65px)"}},[e("div",{staticClass:"otc-up"},[e("div",{staticClass:"pricetip"},[e("span",{staticStyle:{color:"#44566B"}},[t._v(t._s(t.$t("adprice"))+"：")]),e("div",{staticStyle:{"align-self":"center"}},[e("span",{staticStyle:{color:"#44566B"}},[e("b",[t._v(t._s(t.ethcny))])]),e("span",{staticStyle:{color:"gray"}},[t._v(" | ")]),e("span",{staticStyle:{color:"#44566B"}},[t._v("CNY")])])]),e("div",{staticClass:"tr-btn"},[e("q-btn",{staticClass:"otc-btn",attrs:{flat:"",color:"primary",label:t.$t("myorder")},nativeOn:{click:function(a){return t.myorder(a)}}}),e("div",{staticClass:"porti-line"}),e("q-btn",{staticClass:"otc-btn",attrs:{flat:"",color:"primary",label:t.$t("myads")},nativeOn:{click:function(a){return t.myad(a)}}}),e("div",{staticClass:"porti-line"}),e("q-btn",{staticClass:"otc-btn",attrs:{flat:"",color:"primary",label:t.$t("smitad")},nativeOn:{click:function(a){return t.submitAd(a)}}})],1)]),e("div",{staticClass:"otc-down"},t._l(t.ads,(function(a){return e("q-card",{key:a.index,staticClass:"otc-card",nativeOn:{click:function(e){return t.cardClick(a)}}},[e("div",{staticClass:"card-item"},[e("span",{staticStyle:{color:"#3587F2","font-size":"22px"}},[t._v(t._s(t.sellerAddr(a.address)))]),e("span",{staticStyle:{color:"#44566B","font-size":"20px","align-self":"center"}},[t._v(t._s(t.getShowPrice(a.floatrate,a.lowestprice))+" CNY")])]),e("div",{staticClass:"card-item"},[e("div",{staticStyle:{"margin-top":"10px"}},[e("img",{directives:[{name:"show",rawName:"v-show",value:""!==a.alipayno,expression:"item.alipayno!==''"}],staticStyle:{height:"20px","margin-left":"5px"},attrs:{src:"statics/alipays.png"}}),e("img",{directives:[{name:"show",rawName:"v-show",value:""!==a.cardno,expression:"item.cardno!==''"}],staticStyle:{height:"20px","margin-left":"5px"},attrs:{src:"statics/bankcards.png"}}),e("img",{directives:[{name:"show",rawName:"v-show",value:""!==a.weixincodeurl,expression:"item.weixincodeurl!==''"}],staticStyle:{height:"20px","margin-left":"5px"},attrs:{src:"statics/wepay.png"}})]),e("span",{staticStyle:{color:"#6f7d8e","font-size":"13px","align-self":"center"}},[t._v(t._s(t.$t("singlelimit"))+t._s(a.singmin)+" - "+t._s(a.singlemax)+" CNY")])]),e("q-btn",{staticStyle:{width:"30%","align-self":"flex-end"},attrs:{rounded:"",color:"green",label:t.$t("buyeth")}})],1)})),1),e("CustomInfoDialog",{attrs:{dialogData:t.infodialog}}),e("OTCMakeOrderDialog",{attrs:{dialogData:t.otcDialogData,dialogShow:t.otcMakerDialogShow},on:{makeOrder:t.makeOrder}}),e("SetMobileDialog",{attrs:{dialogData:t.setMobileDialogData}})],1)},o=[],n=(e("6b54"),e("06db"),e("c5f6"),e("a002"),e("ef5a")),l=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("q-dialog",{model:{value:t.dialogShow.show,callback:function(a){t.$set(t.dialogShow,"show",a)},expression:"dialogShow.show"}},[e("div",{staticClass:"mydialog"},[e("div",{staticClass:"text-h6",staticStyle:{"margin-left":"10px","margin-top":"10px"}},[t._v(t._s(t.$t("buyeth")))]),e("div",{staticStyle:{"margin-left":"10px","margin-right":"10px"}},[e("div",{staticStyle:{display:"flex"}},[e("span",{staticStyle:{color:"#6f7d8e","font-size":"15px"}},[t._v(t._s(t.$t("buyprice"))+":")]),e("span",[e("span",{staticStyle:{color:"#44566B"}},[t._v(t._s(t.dialogData.price))]),t._v(" \n          "),e("span",{staticStyle:{color:"#6f7d8e","font-size":"15px"}},[t._v("CNY/ETH")])])]),e("q-input",{attrs:{dense:!0,placeholder:t.$t("buyamt"),type:"number"},model:{value:t.buyAmount,callback:function(a){t.buyAmount=a},expression:"buyAmount"}}),e("div",{staticStyle:{color:"#6f7d8e","font-size":"15px","margin-top":"10px"}},[t._v(t._s(t.$t("payamt"))+": "),e("span",{staticClass:"mytx-stress"},[t._v(t._s(Number(t.buyAmount*t.dialogData.price).toFixed(2)))])]),e("span",{staticStyle:{color:"#6f7d8e","font-size":"15px"}},[t._v(t._s(t.$t("paymethod"))+":")]),e("div",{staticStyle:{display:"flex","margin-top":"5px"}},[t.util.isEmpty(t.dialogData.alipayno)?t._e():e("q-radio",{attrs:{dense:"",val:"alipay",label:""},model:{value:t.paymethod,callback:function(a){t.paymethod=a},expression:"paymethod"}}),t.util.isEmpty(t.dialogData.alipayno)?t._e():e("img",{staticStyle:{height:"20px","margin-left":"5px"},attrs:{src:"statics/alipays.png"}}),t.util.isEmpty(t.dialogData.cardno)?t._e():e("q-radio",{attrs:{dense:"",val:"bankcard",label:""},model:{value:t.paymethod,callback:function(a){t.paymethod=a},expression:"paymethod"}}),t.util.isEmpty(t.dialogData.cardno)?t._e():e("img",{staticStyle:{height:"20px","margin-left":"5px"},attrs:{src:"statics/bankcards.png"}}),t.util.isEmpty(t.dialogData.weixincodeurl)?t._e():e("q-radio",{attrs:{dense:"",val:"wepay",label:""},model:{value:t.paymethod,callback:function(a){t.paymethod=a},expression:"paymethod"}}),t.util.isEmpty(t.dialogData.weixincodeurl)?t._e():e("img",{staticStyle:{height:"20px","margin-left":"5px"},attrs:{src:"statics/wepay.png"}})],1),e("q-input",{attrs:{dense:!0,placeholder:t.$t("payaccount")},model:{value:t.payaccount,callback:function(a){t.payaccount=a},expression:"payaccount"}}),e("div",{staticStyle:{color:"#6f7d8e","font-size":"15px","margin-top":"5px"}},[t._v("\n        "+t._s(t.$t("remark"))+": \n        "),e("span",{staticClass:"mytx-stress"},[t._v(t._s(t.dialogData.remarkNumber))])])],1),e("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:t.$t("cancel")}}),e("q-btn",{attrs:{flat:"",label:t.$t("makeorder")},on:{click:t.onOk}})],1)],1)])},r=[],c={props:["dialogData","dialogShow"],data:function(){return{buyAmount:"",payaccount:"",paymethod:""}},methods:{onOk:function(){var t=this.buyAmount*this.dialogData.price;t<this.dialogData.singmin||t>this.dialogData.singlemax?toast(this.$t("orderless",{min:this.dialogData.singmin,max:this.dialogData.singlemax})):this.buyAmount>this.global.otc.otcsingMax?toast(this.$t("ordermore")):""!==this.payaccount?""!==this.paymethod?(this.dialogData.buyamount=this.buyAmount,this.dialogData.payamount=Number(this.buyAmount*this.dialogData.price).toFixed(2),this.dialogData.payaccount=this.payaccount,this.dialogData.paymethod=this.paymethod,this.$emit("makeOrder",this.dialogData),this.dialogShow.show=!1,this.buyAmount=""):toast(this.$t("paymethodnull")):toast(this.$t("fillpayaccount"))}}},d=c,u=(e("68d3"),e("2877")),m=Object(u["a"])(d,l,r,!1,null,"5ff3c784",null),h=m.exports,p=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("q-dialog",{model:{value:t.dialogData.show,callback:function(a){t.$set(t.dialogData,"show",a)},expression:"dialogData.show"}},[e("div",{staticClass:"mydialog"},[e("div",{staticClass:"text-h6",staticStyle:{"margin-left":"10px","margin-top":"10px"}},[t._v(t._s(t.dialogData.title))]),e("div",{staticStyle:{"margin-left":"10px","margin-right":"10px"}},[e("div",{staticStyle:{display:"flex","margin-top":"15px"}},[e("q-input",{staticStyle:{width:"50%"},attrs:{dense:!0,type:"number",placeholder:t.$t("mobile")},model:{value:t.mobile,callback:function(a){t.mobile=a},expression:"mobile"}}),e("q-btn",{attrs:{rounded:"",label:this.$t("sendsmscode")+t.smsbtnTx,color:"primary"},on:{click:t.sendsmscode}})],1),e("q-input",{attrs:{dense:!0,type:"number",placeholder:t.$t("smscode")},model:{value:t.smscode,callback:function(a){t.smscode=a},expression:"smscode"}})],1),e("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:t.$t("cancel")}}),e("q-btn",{attrs:{flat:"",label:t.$t("ok")},on:{click:t.onOk}})],1)],1)])},g=[],b={props:["dialogData"],data:function(){return{mobile:"",smscode:"",smsbtnTx:"",mcount:60}},methods:{smsBtnCountdown:function(){var t=this,a=setInterval((function(){t.smsbtnTx="("+t.mcount+"S)",t.mcount--,-1===t.mcount&&(t.mcount=60,t.smsbtnTx="",clearInterval(a))}),1e3)},sendsmscode:function(){var t=this;/^1(3|4|6|5|7|8)\d{9}$/.test(this.mobile)?60===this.mcount?this.$axios.post(this.global.apiconfig.BmobRestAPIUrl+"requestSmsCode",{mobilePhoneNumber:this.mobile+"",template:"ok0x1"},{headers:this.global.apiconfig.BmobRestAPIHeaders}).then((function(a){t.smsBtnCountdown()})):toast(this.$t("latersend")):toast(this.$t("mobilecheckfail"))},onOk:function(){""!==this.smscode?(this.$q.loading.show({message:this.$t("txsubmiting"),spinnerSize:50}),this.smscodecheck(),this.dialogData.show=!1):toast(this.$t("smsnull"))},smscodecheck:function(){var t=this;this.$axios.post(this.global.apiconfig.BmobRestAPIUrl+"verifySmsCode/"+this.smscode,{mobilePhoneNumber:this.mobile+""},{headers:this.global.apiconfig.BmobRestAPIHeaders}).then((function(a){"ok"===a.data.msg&&t.submitinfo2bmob()})).catch((function(a){console.error(a),toast(t.$t("smscodeerror")),t.$q.loading.hide()}))},submitinfo2bmob:function(){var t=this,a={mobile:this.mobile+""},e=(new Date).getTime();this.$axios.put(this.global.apiconfig.otcbackapi+"otclogin/update_user?address="+this.global.wallet.ethAddress,a,{headers:{"access-token":this.util.generateToken(JSON.stringify(a),e),"otc-timestamp":e}}).then((function(a){t.$q.loading.hide(),200===a.status&&0===a.data.code&&(t.global.user.mobile=t.mobile+"",toast(t.$t("setsuccess")))}))}}},f=b,y=(e("d92e"),Object(u["a"])(f,p,g,!1,null,"2a332060",null)),v=y.exports,x=e("f5ef"),w={components:{CustomInfoDialog:n["a"],OTCMakeOrderDialog:h,SetMobileDialog:v},data:function(){return{title:"SmartOTC",infodialog:{show:!1,vhtml:"",ok:this.$t("ok")},otcDialogData:{},otcMakerDialogShow:{show:!1},ethcny:"",ads:this.global.otc.adlist,setMobileDialogData:{show:!1,title:this.$t("setmobile")},isHaveAD:!1}},mounted:function(){var t=this;this.getETHPrice(),i=setInterval((function(){t.getETHPrice()}),6e4),this.getAdList(),this.checkIsHaveAd(),x["a"].$on("jimloginOK",(function(){t.onTransMsgRec()})),"undefined"!==typeof JIM&&JIM.isInit()&&JIM.isLogin()&&this.onTransMsgRec()},methods:{transSingleMsg:function(t,a){JIM.transSingleMsg({target_username:t,cmd:a}).onSuccess((function(t){})).onFail((function(t){}))},onTransMsgRec:function(){var t=this;JIM.onTransMsgRec((function(a){"newOrder"===JSON.parse(a.cmd).type&&toast(t.$t("newOrder"))}))},sellerAddr:function(t){return t===this.global.wallet.ethAddress?t.substring(37)+"（我）":t.substring(37)},makeOrder:function(t){var a=this,e=this;this.$q.loading.show({message:e.$t("txsubmiting"),spinnerSize:50});var i={buyer:this.global.wallet.ethAddress,seller:t.address,amount:t.buyamount+"",value:parseFloat(Number(t.buyamount*t.price).toFixed(2))+"",status:0,buy_price:parseFloat(t.price)+"",seller_alipay_no:t.alipayno,seller_card_no:t.cardno,pay_account:t.payaccount,pay_method:t.paymethod,remark:t.remarkNumber,buyer_mobile:this.global.user.mobile,seller_mobile:t.mobile,weixin_code_url:t.weixincodeurl,seller_actual_name:t.actualname},s=(new Date).getTime();this.$axios.post(this.global.apiconfig.otcbackapi+"otcorders/create_order",i,{headers:{"access-token":this.util.generateToken(JSON.stringify(i),s),"otc-timestamp":s}}).then((function(s){if(e.$q.loading.hide(),200===s.status&&0===s.data.code){toast(e.$t("makerorderok")),i.create_at=s.data.data.create_at,i.id=s.data.data.id,a.$router.push({path:"/OrderDetail",query:{item:i,type:"buy"}}),e.util.sendsmstips(e,t.mobile,"a");var o={type:"newOrder",data:""};a.transSingleMsg(i.seller.substring(2),JSON.stringify(o))}}))},cardClick:function(t){if(t.address===this.global.wallet.ethAddress)this.$router.push({path:"/MyOTCAD",query:{ethcny:this.ethcny}});else{if(this.util.isEmpty(this.global.user.mobile))return toast(this.$t("mobilenotreg")),void(this.setMobileDialogData.show=!0);t.price=this.getShowPrice(t.floatrate,t.lowestprice),t.remarkNumber=Math.random().toString().slice(-6),this.otcDialogData=t,this.otcMakerDialogShow.show=!0}},getShowPrice:function(t,a){var e=this.ethcny*(1+parseFloat(t)/100);return Number(e<a?a:e).toFixed(4)},getAdList:function(){var t=this,a={status:"live"},e=(new Date).getTime();this.$axios.get(this.global.apiconfig.otcbackapi+"otcad/get_ad",{params:a,headers:{"access-token":this.util.generateToken(JSON.stringify(a),e),"otc-timestamp":e}}).then((function(a){200===a.status&&0===a.data.code&&(t.ads=a.data.data.rows,t.global.otc.adlist=a.data.data.rows)}))},myad:function(){this.$router.push({path:"/MyOTCAD",query:{ethcny:this.ethcny}})},myorder:function(){this.$router.push("/MyOTCOrder")},getETHPrice:function(){var t=this,a="https://fxhapi.feixiaohao.com/public/v1/ticker?start=1&limit=1&convert=CNY";this.$axios.get(a).then((function(a){var e=a.data[0].price_cny;t.ethcny=Number(e).toFixed(4)})).catch((function(t){})).then((function(){}))},submitAd:function(){var t=this;""!==this.global.user.cardno&&"undefined"!==typeof this.global.user.cardno||""!==this.global.user.alipayno&&"undefined"!==typeof this.global.user.alipayno||""!==this.global.user.weixin&&"undefined"!==typeof this.global.user.weixin?this.isHaveAD?toast(this.$t("onlycanhave1ad")):this.$router.push({path:"/SubmitAD",query:{item:{tradeamount:"",floatrate:"0",lowestprice:"",cardno:"",alipayno:"",weixincodeurl:"",singmin:"",singlemax:""},from:"smartotc"}}):this.$q.dialog({message:this.$t("receiptinfo")}).onOk((function(){t.$router.push({path:"/SetPaymentInfo",query:{p1:""}})}))},checkIsHaveAd:function(){var t=this,a={address:this.global.wallet.ethAddress,status:"live"},e=(new Date).getTime();this.$axios.get(this.global.apiconfig.otcbackapi+"otcad/get_ad",{params:a,headers:{"access-token":this.util.generateToken(JSON.stringify(a),e),"otc-timestamp":e}}).then((function(a){200===a.status&&0===a.data.code&&(0!==a.data.data.rows.length?t.isHaveAD=!0:t.isHaveAD=!1)}))}},beforeDestroy:function(){clearInterval(i)}},_=w,k=(e("300c"),Object(u["a"])(_,s,o,!1,null,"7eedbde5",null));a["default"]=k.exports},"68d3":function(t,a,e){"use strict";var i=e("400a"),s=e.n(i);s.a},a157:function(t,a,e){},d92e:function(t,a,e){"use strict";var i=e("ed4e"),s=e.n(i);s.a},ed4e:function(t,a,e){},ef5a:function(t,a,e){"use strict";var i=function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("q-dialog",{model:{value:t.dialogData.show,callback:function(a){t.$set(t.dialogData,"show",a)},expression:"dialogData.show"}},[e("div",{staticClass:"mydialog"},[e("div",{staticClass:"text-h6",staticStyle:{"margin-left":"10px","margin-top":"10px"}},[t._v(t._s(t.dialogData.msg))]),e("div",{staticStyle:{"margin-left":"10px","margin-right":"10px"}},[e("span",{staticClass:"cid-tx",domProps:{innerHTML:t._s(t.dialogData.vhtml)}})]),e("q-card-actions",{staticClass:"text-primary",attrs:{align:"right"}},[e("q-btn",{directives:[{name:"close-popup",rawName:"v-close-popup"}],attrs:{flat:"",label:t.$t("ok")}})],1)],1)])},s=[],o={props:["dialogData"],data:function(){return{}},methods:{}},n=o,l=(e("1663"),e("2877")),r=Object(l["a"])(n,i,s,!1,null,"1263c430",null);a["a"]=r.exports}}]);